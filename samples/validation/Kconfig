# Subsystem enabling

DT_CHOSEN_Z_BT_HCI := zephyr,bt-hci
DT_CHOSEN_Z_WIFI := zephyr,wifi
DT_COMPAT_Z_SDMMC := zephyr,sdmmc-disk
DT_COMPAT_ST_SDMMC := st,stm32-sdmmc

config VALIDATION_NRF70_XO_TUNE
	bool "Run external oscillator calibration"
	depends on $(dt_chosen_enabled,$(DT_CHOSEN_Z_WIFI))
	depends on !NETWORKING

configdefault BT
	default y if $(dt_chosen_enabled,$(DT_CHOSEN_Z_BT_HCI))
configdefault NETWORKING
	default y if $(dt_chosen_enabled,$(DT_CHOSEN_Z_WIFI))
configdefault WIFI
	default y if $(dt_chosen_enabled,$(DT_CHOSEN_Z_WIFI))
configdefault DISK_ACCESS
	default y if $(dt_compat_enabled,$(DT_COMPAT_Z_SDMMC))
	default y if $(dt_compat_enabled,$(DT_COMPAT_ST_SDMMC))
configdefault GNSS
	default y if $(dt_alias_enabled,gnss)
configdefault LORA
	default y if $(dt_alias_enabled,lora0)
configdefault FUEL_GAUGE
	default y if "$(dt_alias_enabled,fuel-gauge0)"
configdefault INFUSE_VALIDATION_LEDS_GPIO
	default y if $(dt_alias_enabled,led0)
configdefault INFUSE_VALIDATION_LEDS_CONTROLLER
	default y if $(dt_alias_enabled,led-controller0)
choice NRF70_OPER_MODES
	default NRF70_RADIO_TEST if VALIDATION_NRF70_XO_TUNE
endchoice


# Floating point

configdefault FPU
	# nRF70 Wi-Fi libraries are currently hardcoded to software FP
	default n if WIFI_NRF70
	default y if CPU_HAS_FPU
configdefault CBPRINTF_FP_SUPPORT
	default y

# System heap usage

configdefault SYS_HEAP_RUNTIME_STATS
	default y
configdefault SYS_HEAP_ARRAY_SIZE
	default 4

# Larger logging buffer sizes

configdefault LOG_BUFFER_SIZE
	default 4096 if NRF_WIFI_LOW_RAM
	default 16384

configdefault SEGGER_RTT_BUFFER_SIZE_UP
	default 4096 if NRF_WIFI_LOW_RAM
	default 16384

# Networking options

configdefault NET_CONNECTION_MANAGER_CONNECTIVITY_WIFI_MGMT
	default n
configdefault CONN_MGR_WIFI_KV_STORE
	default n
configdefault SNTP_AUTO
	default n

# GNSS options

config GNSS_VALIDATION_SUPPORTED
	bool
	depends on GNSS_UBX_MODEM || GNSS_NRF9X
	default y

# nRF9x options

configdefault LTE_LC_NEIGHBOR_CELL_MEAS_MODULE
	default y

# Driver configuration

configdefault INFUSE_IMU_SELF_TEST
	default y

choice LORA_MODULE_BACKEND
	default LORA_MODULE_BACKEND_LORA_BASICS_MODEM
endchoice

# Log suppression

configdefault INFUSE_MODEM_MONITOR_LOG_LEVEL
	default 2
configdefault EPACKET_UDP_LOG_LEVEL
	default 2
configdefault WIFI_NRF70_BUSLIB_LOG_LEVEL
	default 2
configdefault SD_LOG_LEVEL
	default 2
configdefault MODEM_LOG_LEVEL
	default 2

source "Kconfig.zephyr"
