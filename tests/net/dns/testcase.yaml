common:
  tags: infuse net
  min_flash: 64
  min_ram: 32
tests:
  net.dns.wifi:
    build_only: true
    integration_platforms:
      - nrf7002dk/nrf5340/cpuapp
    required_snippets:
      - infuse
    depends_on:
      - netif
      - wifi
  net.dns.native:
    platform_allow:
      - native_sim
    integration_platforms:
      - native_sim
    extra_args:
      - OVERLAY_CONFIG="overlay-nsos.conf"
    harness: console
    harness_config:
      type: multi_line
      ordered: true
      regex:
        - "google.com -> ([\\d\\.]+)"
        - "not.a.real.address -> Lookup failed"
        - "google.com -> ([0-9A-Fa-f:]+)"
        - "Started DNS query for 'google.com' \\(ID [0-9A-F]{4}\\)"
        - "[0-9A-F]{4} -> ([\\d\\.]+)"
        - "Started DNS query for 'not.a.real.address' \\(ID [0-9A-F]{4}\\)"
        - "[0-9A-F]{4} -> DNS resolving error"
        - "Started DNS query for 'google.com' \\(ID [0-9A-F]{4}\\)"
        - "[0-9A-F]{4} -> ([0-9A-Fa-f:]+)"
        - "Started DNS query for 'not.a.real.address' \\(ID [0-9A-F]{4}\\)"
        - "[0-9A-F]{4} -> DNS resolving error"
