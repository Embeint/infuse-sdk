/**
 * @file
 * @copyright 2025 Embeint Holdings Pty Ltd
 * @author Jordan Yates <jordan@embeint.com>
 *
 * SPDX-License-Identifier: FSL-1.1-ALv2
 */

#ifndef INFUSE_SDK_DRIVERS_SENSOR_BQ25798_H_
#define INFUSE_SDK_DRIVERS_SENSOR_BQ25798_H_

#ifdef __cplusplus
extern "C" {
#endif

enum {
	BQ25798_REG_MIN_SYS_VOLTAGE = 0x00,
	BQ25798_REG_CHARGE_VOLTAGE_LIM = 0x01,
	BQ25798_REG_CHARGE_CURRENT_LIM = 0x03,
	BQ25798_REG_INPUT_VOLTAGE_LIM = 0x05,
	BQ25798_REG_INPUT_CURRENT_LIM = 0x06,
	BQ25798_REG_PRECHARGE_CONTROL = 0x08,
	BQ25798_REG_TERM_CONTROL = 0x09,
	BQ25798_REG_RECHARGE_CONTROL = 0x0A,
	BQ25798_REG_VOTG_REGULATION = 0x0B,
	BQ25798_REG_IOTG_REGULATION = 0x0D,
	BQ25798_REG_TIMER_CONTROL = 0x0E,
	BQ25798_REG_CHARGER_CONTROL_0 = 0x0F,
	BQ25798_REG_CHARGER_CONTROL_1 = 0x10,
	BQ25798_REG_CHARGER_CONTROL_2 = 0x11,
	BQ25798_REG_CHARGER_CONTROL_3 = 0x12,
	BQ25798_REG_CHARGER_CONTROL_4 = 0x13,
	BQ25798_REG_CHARGER_CONTROL_5 = 0x14,
	BQ25798_REG_MPPT_CONTROL = 0x15,
	BQ25798_REG_TEMPERATURE_CONTROL = 0x16,
	BQ25798_REG_NTC_CONTROL_0 = 0x17,
	BQ25798_REG_NTC_CONTROL_1 = 0x18,
	BQ25798_REG_ICO_CURRENT_LIMIT = 0x19,
	BQ25798_REG_CHARGER_STATUS_0 = 0x1B,
	BQ25798_REG_CHARGER_STATUS_1 = 0x1C,
	BQ25798_REG_CHARGER_STATUS_2 = 0x1D,
	BQ25798_REG_CHARGER_STATUS_3 = 0x1E,
	BQ25798_REG_CHARGER_STATUS_4 = 0x1F,
	BQ25798_REG_FAULT_STATUS_0 = 0x20,
	BQ25798_REG_FAULT_STATUS_1 = 0x21,
	BQ25798_REG_CHARGER_FLAG_0 = 0x22,
	BQ25798_REG_CHARGER_FLAG_1 = 0x23,
	BQ25798_REG_CHARGER_FLAG_2 = 0x24,
	BQ25798_REG_CHARGER_FLAG_3 = 0x25,
	BQ25798_REG_FAULT_FLAG_0 = 0x26,
	BQ25798_REG_FAULT_FLAG_1 = 0x27,
	BQ25798_REG_CHARGER_MASK_0 = 0x28,
	BQ25798_REG_CHARGER_MASK_1 = 0x29,
	BQ25798_REG_CHARGER_MASK_2 = 0x2A,
	BQ25798_REG_CHARGER_MASK_3 = 0x2B,
	BQ25798_REG_FAULT_MASK_0 = 0x2C,
	BQ25798_REG_FAULT_MASK_1 = 0x2D,
	BQ25798_REG_ADC_CONTROL = 0x2E,
	BQ25798_REG_ADC_FUNC_DISABLE_0 = 0x2F,
	BQ25798_REG_ADC_FUNC_DISABLE_1 = 0x30,
	BQ25798_REG_IBUS_ADC = 0x31,
	BQ25798_REG_IBAT_ADC = 0x33,
	BQ25798_REG_VBUS_ADC = 0x35,
	BQ25798_REG_VAC1_ADC = 0x37,
	BQ25798_REG_VAC2_ADC = 0x39,
	BQ25798_REG_VBAT_ADC = 0x3B,
	BQ25798_REG_VSYS_ADC = 0x3D,
	BQ25798_REG_TS_ADC = 0x3F,
	BQ25798_REG_TDIE_ADC = 0x41,
	BQ25798_REG_DP_ADC = 0x43,
	BQ25798_REG_DM_ADC = 0x45,
	BQ25798_REG_DPDM_DRIVER = 0x47,
	BQ25798_REG_PART_INFO = 0x48,
};

#define BQ25798_TERM_CONTROL_REG_RST BIT(6)

#define BQ25798_CHARGER_CONTROL_0_EN_CHG    BIT(5)
#define BQ25798_CHARGER_CONTROL_0_EN_ICO    BIT(4)
#define BQ25798_CHARGER_CONTROL_0_FORCE_ICO BIT(3)
#define BQ25798_CHARGER_CONTROL_0_EN_HIZ    BIT(2)
#define BQ25798_CHARGER_CONTROL_0_EN_TERM   BIT(1)

#define BQ25798_CHARGER_CONTROL_1_OVP_7V     (3 << 4)
#define BQ25798_CHARGER_CONTROL_1_OVP_12V    (2 << 4)
#define BQ25798_CHARGER_CONTROL_1_OVP_22V    (1 << 4)
#define BQ25798_CHARGER_CONTROL_1_OVP_26V    (0 << 4)
#define BQ25798_CHARGER_CONTROL_1_WD_RST     BIT(3)
#define BQ25798_CHARGER_CONTROL_1_WD_DISABLE 0b000
#define BQ25798_CHARGER_CONTROL_1_WD_500MS   0b001
#define BQ25798_CHARGER_CONTROL_1_WD_1S      0b010
#define BQ25798_CHARGER_CONTROL_1_WD_2S      0b011
#define BQ25798_CHARGER_CONTROL_1_WD_20S     0b100
#define BQ25798_CHARGER_CONTROL_1_WD_40S     0b101
#define BQ25798_CHARGER_CONTROL_1_WD_80S     0b110
#define BQ25798_CHARGER_CONTROL_1_WD_160S    0b111

#define BQ25798_CHARGER_CONTROL_4_EN_ACDRV2   BIT(7)
#define BQ25798_CHARGER_CONTROL_4_EN_ACDRV1   BIT(6)
#define BQ25798_CHARGER_CONTROL_4_EN_IBUS_OCP BIT(0)

#define BQ25798_CHARGER_CONTROL_5_SFET_PRESENT     BIT(7)
#define BQ25798_CHARGER_CONTROL_5_EN_IBAT          BIT(5)
#define BQ25798_CHARGER_CONTROL_5_IBAT_REG_DISABLE (BIT(4) | BIT(3))
#define BQ25798_CHARGER_CONTROL_5_EN_IINDPM        BIT(2)
#define BQ25798_CHARGER_CONTROL_5_EN_EXTILIM       BIT(1)
#define BQ25798_CHARGER_CONTROL_5_EN_BATOC         BIT(0)

#define BQ25798_MPPT_CONTROL_RATIO_OFFSET     5
#define BQ25798_MPPT_CONTROL_VOC_DELAY_50MS   (0x0 << 3)
#define BQ25798_MPPT_CONTROL_VOC_DELAY_300MS  (0x1 << 3)
#define BQ25798_MPPT_CONTROL_VOC_DELAY_2S     (0x2 << 3)
#define BQ25798_MPPT_CONTROL_VOC_DELAY_5S     (0x3 << 3)
#define BQ25798_MPPT_CONTROL_VOC_PERIOD_30S   (0x0 << 1)
#define BQ25798_MPPT_CONTROL_VOC_PERIOD_2MIN  (0x1 << 1)
#define BQ25798_MPPT_CONTROL_VOC_PERIOD_10MIN (0x2 << 1)
#define BQ25798_MPPT_CONTROL_VOC_PERIOD_30MIN (0x3 << 1)
#define BQ25798_MPPT_CONTROL_MPPT_ENABLE      BIT(0)
#define BQ25798_MPPT_CONTROL_MPPT_DISABLE     0x00

#define BQ25798_CHARGER_STATUS_0_POWER_GOOD   BIT(3)
#define BQ25798_CHARGER_STATUS_0_AC2_PRESENT  BIT(2)
#define BQ25798_CHARGER_STATUS_0_AC1_PRESENT  BIT(1)
#define BQ25798_CHARGER_STATUS_0_VBUS_PRESENT BIT(0)

#define BQ25798_CHARGER_STATUS_1_NOT_CHARGING   (0x0 << 5)
#define BQ25798_CHARGER_STATUS_1_TRICKLE_CHARGE (0x1 << 5)
#define BQ25798_CHARGER_STATUS_1_PRE_CHARGE     (0x2 << 5)
#define BQ25798_CHARGER_STATUS_1_FAST_CHARGE    (0x3 << 5)
#define BQ25798_CHARGER_STATUS_1_TAPER_CHARGE   (0x4 << 5)
#define BQ25798_CHARGER_STATUS_1_TOP_OFF        (0x6 << 5)
#define BQ25798_CHARGER_STATUS_1_TERM_DONE      (0x7 << 5)
#define BQ25798_CHARGER_STATUS_1_CHG_STAT_MASK  (0x7 << 5)
#define BQ25798_CHARGER_STATUS_1_CHG_STAT_OFF   5
#define BQ25798_CHARGER_STATUS_1_BC12_DONE      BIT(0)

#define BQ25798_CHARGER_STATUS_2_TREG         BIT(2)
#define BQ25798_CHARGER_STATUS_2_DPDM         BIT(1)
#define BQ25798_CHARGER_STATUS_2_VBAT_PRESENT BIT(0)

#define BQ25798_CHARGER_STATUS_3_ACRB2    BIT(7)
#define BQ25798_CHARGER_STATUS_3_ACRB1    BIT(6)
#define BQ25798_CHARGER_STATUS_3_ADC_DONE BIT(5)
#define BQ25798_CHARGER_STATUS_3_VSYS     BIT(4)

#define BQ25798_CHARGER_STATUS_4_VBATOTG_LOW BIT(4)
#define BQ25798_CHARGER_STATUS_4_TS_COLD     BIT(3)
#define BQ25798_CHARGER_STATUS_4_TS_COOL     BIT(2)
#define BQ25798_CHARGER_STATUS_4_TS_WARM     BIT(1)
#define BQ25798_CHARGER_STATUS_4_TS_HOT      BIT(0)

#define BQ25798_CHARGER_FLAG_2_DPDM_DONE  BIT(6)
#define BQ25798_CHARGER_FLAG_2_ADC_DONE   BIT(5)
#define BQ25798_CHARGER_FLAG_2_VSYS       BIT(4)
#define BQ25798_CHARGER_FLAG_2_CHG_TMR    BIT(3)
#define BQ25798_CHARGER_FLAG_2_TRICH_TMR  BIT(2)
#define BQ25798_CHARGER_FLAG_2_PRECHG_TMR BIT(1)
#define BQ25798_CHARGER_FLAG_2_TOPOFF_TMR BIT(0)

#define BQ25798_CHARGER_FAULT_0_VAC2_OVP BIT(1)
#define BQ25798_CHARGER_FAULT_0_VAC1_OVP BIT(0)

#define BQ25798_ADC_CONTROL_EN          BIT(7)
#define BQ25798_ADC_CONTROL_ONE_SHOT    BIT(6)
#define BQ25798_ADC_CONTROL_CONTINUOUS  0x00
#define BQ25798_ADC_CONTROL_15_BIT      (0x0 << 4)
#define BQ25798_ADC_CONTROL_14_BIT      (0x1 << 4)
#define BQ25798_ADC_CONTROL_13_BIT      (0x2 << 4)
#define BQ25798_ADC_CONTROL_12_BIT      (0x3 << 4)
#define BQ25798_ADC_CONTROL_RUNNING_AVG BIT(3)

#define BQ25798_ADC_FUNC_DISABLE_0_IBUS BIT(7)
#define BQ25798_ADC_FUNC_DISABLE_0_IBAT BIT(6)
#define BQ25798_ADC_FUNC_DISABLE_0_VBUS BIT(5)
#define BQ25798_ADC_FUNC_DISABLE_0_VBAT BIT(4)
#define BQ25798_ADC_FUNC_DISABLE_0_VSYS BIT(3)
#define BQ25798_ADC_FUNC_DISABLE_0_TS   BIT(2)
#define BQ25798_ADC_FUNC_DISABLE_0_TDIE BIT(1)

#define BQ25798_ADC_FUNC_DISABLE_1_DP   BIT(7)
#define BQ25798_ADC_FUNC_DISABLE_1_DM   BIT(6)
#define BQ25798_ADC_FUNC_DISABLE_1_VAC2 BIT(5)
#define BQ25798_ADC_FUNC_DISABLE_1_VAC1 BIT(4)

#define BQ25798_PART_INFO_EXPECTED 0x19

#ifdef __cplusplus
}
#endif

#endif /* INFUSE_SDK_DRIVERS_SENSOR_BQ25798_H_ */
