# ePacket compilation

zephyr_library_named(epacket)

zephyr_library_sources(epacket.c handlers.c)
zephyr_library_sources_ifdef(CONFIG_EPACKET_FILTERING filter.c)
zephyr_library_sources_ifdef(CONFIG_EPACKET_CRYPTO
  keys.c
  interfaces/epacket_common_crypt.c
)
zephyr_library_sources_ifdef(CONFIG_EPACKET_FORWARDING forwarding.c)
zephyr_library_sources_ifdef(CONFIG_EPACKET_SECURITY_TEST_STUBS security_test_stubs.c)

zephyr_library_sources_ifdef(CONFIG_EPACKET_INTERFACE_BT_ADV interfaces/epacket_bt_adv.c)
zephyr_library_sources_ifdef(CONFIG_EPACKET_INTERFACE_BT_ADV interfaces/epacket_bt_adv_crypt.c)
zephyr_library_sources_ifdef(CONFIG_EPACKET_INTERFACE_BT_CENTRAL interfaces/epacket_bt_central.c)
zephyr_library_sources_ifdef(CONFIG_EPACKET_INTERFACE_BT_PERIPHERAL interfaces/epacket_bt_peripheral.c)
zephyr_library_sources_ifdef(CONFIG_EPACKET_INTERFACE_BT_GATT interfaces/epacket_bt_gatt_crypt.c)
zephyr_library_sources_ifdef(CONFIG_EPACKET_INTERFACE_UDP interfaces/epacket_udp.c)
zephyr_library_sources_ifdef(CONFIG_EPACKET_INTERFACE_UDP interfaces/epacket_udp_crypt.c)
zephyr_library_sources_ifdef(CONFIG_EPACKET_INTERFACE_SERIAL interfaces/epacket_serial_crypt.c)
zephyr_library_sources_ifdef(CONFIG_EPACKET_INTERFACE_SERIAL_BACKEND_INT interfaces/epacket_serial_interrupt.c)
zephyr_library_sources_ifdef(CONFIG_EPACKET_INTERFACE_SERIAL_BACKEND_ASYNC interfaces/epacket_serial_async.c)
zephyr_library_sources_ifdef(CONFIG_EPACKET_INTERFACE_SERIAL_BACKEND_RTT interfaces/epacket_serial_rtt.c)
zephyr_library_sources_ifdef(CONFIG_EPACKET_INTERFACE_HCI interfaces/epacket_hci.c)
zephyr_library_sources_ifdef(CONFIG_EPACKET_INTERFACE_DUMMY interfaces/epacket_dummy.c)

if(CONFIG_EPACKET_INTERFACE_ZTEST_PACKETS)
  zephyr_library_sources(interfaces/epacket_bt_adv_crypt.c)
  zephyr_library_sources(interfaces/epacket_bt_gatt_crypt.c)
  zephyr_library_sources(interfaces/epacket_udp_crypt.c)
  zephyr_library_sources(interfaces/epacket_serial_crypt.c)
endif()

zephyr_library_link_libraries_ifdef(CONFIG_MBEDTLS mbedTLS)
